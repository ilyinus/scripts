cat rphost*/*.log | sed -r 's/\xef\xbb\xbf//g' | gawk -vORS='<LineBreak>' '{if (match($0, "^[0-9]+:[0-9]+\\.[0-9]+-")) print "\n"$0; else print $0;}' | grep -e ',TLOCK,' | sed -r 's/[0-9]+:[0-9]+\.[0-9]+-//;s/TLOCK.*Regions=//;s/,Locks.*Context=/<LineBreak>Context=/' | gawk -F',' '{Dur[$2]+=$1; Count[$2]+=1}END{for (i in Dur) {print "-------------------------------------------------------------------<LineBreak>" Dur[i]/1000000 " длительность (сек); " Count[i] " кол-во;<LineBreak>-------------------------------------------------------------------<LineBreak>" i "<LineBreak><LineBreak>"}}' | sort -rnb -t';' -k 1 | sed -r 's/<LineBreak>/\n/g' > Locks.txt